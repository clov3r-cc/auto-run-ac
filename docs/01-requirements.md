# エアコン自動制御システム 要件定義

## 背景・目的

### 解決したい課題

- 帰宅時に部屋が暑すぎる/寒すぎる問題
- エアコンのつけ忘れによる不快な帰宅体験
- 手動でのエアコン操作の手間

### システムの価値

- 帰宅時に快適な室温を実現
- 外出先からの操作不要で自動調整
- 省エネ（必要な時間のみ稼働）

### 利用シーン

- 平日の定時帰宅
- 不規則な帰宅時間への対応
- 季節や天候に関係ない快適性確保

## 概要

SwitchBot APIを使用してエアコンを自動制御するWebアプリケーション。ユーザーが設定したスケジュールに基づいて、帰宅前に適切な温度にエアコンを自動調整する。

## 機能要件

### バックエンド機能

#### 自動制御機能

- 現在の温度監視
- スケジュール設定に基づく制御判定
- SwitchBot経由でのエアコン制御
- 実行結果の記録

### フロントエンド機能

#### ダッシュボード

- 現在の温度表示
- システム状態表示
- 次回実行予定時刻表示
- 最新の実行結果表示

#### スケジュール管理

- **デフォルトスケジュール設定**
  - 帰宅時刻設定実装仕様
- **特定日スケジュール設定**
  - カレンダー形式での日付選択
  - 選択日の個別設定（帰宅時刻・無効化）
  - 設定済み特別日の一覧表示
  - 設定の削除機能

#### システム設定

- システム全体の有効/無効切り替え
- デバイス情報確認

#### 履歴・監視

- 実行履歴の表示
- 日付範囲での絞り込み
- 実行結果の詳細表示

## データ管理

### スケジュールデータ

- デフォルトスケジュール
- 特定日スケジュール（日付ごと）
- 各スケジュールの有効/無効状態

### システム設定データ

- システム全体の有効/無効状態
- デバイス設定情報

### 履歴データ

- 実行日時と結果
- 実行時の温度情報
- エラー情報

## 実装方針

### アーキテクチャ

- フロントエンド：React Router
- バックエンド：Cloudflare Workers（定期実行のみ）
- データ保存：Cloudflare KV（フロントエンドから直接操作）
- 外部連携：SwitchBot API、Discord Webhook

### データアクセスパターン

- フロントエンドがKVに直接読み書き
- バックエンドは定期実行時のみKVを参照・更新
- 設定変更は即座にKVに反映
